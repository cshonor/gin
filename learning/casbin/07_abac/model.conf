# ABAC = Attribute-Based Access Control，基于属性的访问控制
# sub、obj 可为结构体，matcher 中通过 r.sub.xxx、r.obj.xxx 访问属性
# 纯 ABAC 无需 policy，直接根据属性判断

[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# admin 可做任何操作；否则需 sub.Department == obj.Department 且 act 为 read
# p.sub=="_" 为占位策略，纯 ABAC 需至少一条 policy 供 matcher 匹配
m = (r.sub.Role == "admin" || (r.sub.Department == r.obj.Department && r.act == "read")) && p.sub == "_"

